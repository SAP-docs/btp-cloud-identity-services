<!-- loioc62c09e058884f6ca49f7158e2b41321 -->

# Call Identity Authentication Refresh Token

The refresh token is used to receive a new id token and access token, to be used when the old token is not valid or expires.



To get an id token or access token via the refresh token for the first time the client must have a refresh token received via either the authorization code flow or the resource owner password credentials flow. For more information, see [Call Identity Authentication Refresh Token](call-identity-authentication-refresh-token-c62c09e.md), or [Configure the Client to Call Identity Authentication Token Endpoint for Resource Owner Password Credentials Flow](configure-the-client-to-call-identity-authentication-token-endpoint-for-resource-owner-pa-67f720d.md). Once the client has a valid refresh token it can be used to call the token endpoint to receive a new id token and access token.



## **Request**

**URI:**<code>https://&lt;Cloud Identity Services domain&gt;/oauth2/token</code>

> ### Note:  
> The domain part has the following pattern:
> 
> `<tenant ID>.accounts.ondemand.com` or `<tenant ID>.accounts.cloud.sap`. If you have a configured custom domain, the domain has the following pattern: <your custom domain\>.
> 
> *Tenant ID* is an automatically generated ID by the system. The first administrator created for the tenant receives an activation email with a URL in it. This URL contains the *tenant ID*. For more information about your tenants, see [View Assigned Tenants and Admins](../view-assigned-tenants-and-admins-f56e6f2.md).

**HTTP Method:***POST*



### Request Headers


<table>
<tr>
<th valign="top">

Header

</th>
<th valign="top">

Required

</th>
<th valign="top">

Values

</th>
</tr>
<tr>
<td valign="top">

`Content-Type`

</td>
<td valign="top">

Yes

</td>
<td valign="top">

application/x-www-form-urlencoded

</td>
</tr>
<tr>
<td valign="top">

`Authorization`

</td>
<td valign="top">

Yes

</td>
<td valign="top">

-   `Basic` Username and password are:

    Client ID and a Secret to authenticate the client \(relying party\). For more information, see [Configure Secrets for API Authentication](configure-secrets-for-api-authentication-5c3c35e.md).

    > ### Note:  
    > The client ID and secret must be encoded using the "application/x-www-form-urlencoded" encoding algorithm.

-   X.509 Certificate
-   JWT \(client\_assertion\)



</td>
</tr>
</table>



### Request Parameters


<table>
<tr>
<th valign="top">

Parameter

</th>
<th valign="top">

Required

</th>
<th valign="top">

Data Type

</th>
<th valign="top">

Description

</th>
<th valign="top">

Parameter Type

</th>
</tr>
<tr>
<td valign="top">

`grant_type`

</td>
<td valign="top">

Yes

</td>
<td valign="top">

string

</td>
<td valign="top">

refresh\_token

</td>
<td valign="top">

Request body

</td>
</tr>
<tr>
<td valign="top">

`refresh_token`

</td>
<td valign="top">

Yes

</td>
<td valign="top">

string

</td>
<td valign="top">

The `refresh_token` generated by Identity Authentication in the token endpoint of the supported flows. It is returned with the request to the token endpoint.

If `token_format` was specified in `grant_type` before, for example `authorization_code`, this format is re-used in the refresh token endpoint.

> ### Note:  
> The validity of the `refresh_token` after it is generated and returned in the URL is the same as timeout session for Identity Authentication. For more information about the session timeout feature, see [Configure Session Timeout](configure-session-timeout-5ca23e4.md).



</td>
<td valign="top">

Request body

</td>
</tr>
<tr>
<td valign="top">

`refresh_expiry`

</td>
<td valign="top">

No

</td>
<td valign="top">

string

</td>
<td valign="top">

Reduces the expiration of a refresh token. It's useful if your application is called from mobile and web applications, and both have different session requirements. If you set the token lifetime to 0, you won't receive a `refresh_token` in response.

</td>
<td valign="top">

Request body

</td>
</tr>
<tr>
<td valign="top">

`token_format`

</td>
<td valign="top">

No

</td>
<td valign="top">

string

</td>
<td valign="top">

The `token_format` can be set to `opaque` to retrieve an opaque access token or to `jwt` to retrieve a JWT based access token. If not set, the current defaults per grant type are used.

</td>
<td valign="top">

Request body

</td>
</tr>
<tr>
<td valign="top">

`app_tid`

</td>
<td valign="top">

No

</td>
<td valign="top">

string

</td>
<td valign="top">

Reserved.

</td>
<td valign="top">

Request body

</td>
</tr>
</table>



### Request Example

```
grant_type=refresh_token&refresh_token=d12a12abcd198765dd54r456e98321
```



## **Response**



### Response Status and Error Codes


<table>
<tr>
<th valign="top">

Code

</th>
<th valign="top">

Reason

</th>
<th valign="top">

Description

</th>
</tr>
<tr>
<td valign="top">

200 OK

</td>
<td valign="top">

Successful operation.

</td>
<td valign="top">

Returns `access_token`, `refresh_token`, and `id_token`. The `id_token` is valid for 60 minutes.

</td>
</tr>
<tr>
<td valign="top">

400 Bad Request

</td>
<td valign="top">

Missing or wrong parameter.

</td>
<td valign="top">

Returns an information about the error.

</td>
</tr>
<tr>
<td valign="top">

401 Unauthorized

</td>
<td valign="top">

Wrong user ID or password parameters passed for the basic authentication. For more information, see [Configure Secrets for API Authentication](configure-secrets-for-api-authentication-5c3c35e.md).

</td>
<td valign="top">

The authentication of the client \(relying party\) failed.

</td>
</tr>
</table>



### Response Payload Example

```

{
 "access_token": "123ab87c-8p54-7ab9-7a9s-sfde12345678",
 "refresh_token": "s34s32as23r12345dt85r178e30701"
 "id_token": 
"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxMmEzNGI1Yy02ZDc4LTllMW
YtZzM0NS02N2g4OWlqa2wxMjMiLCJzdWIiOiJQMTIzNDU2IiwibWFpbCI6ImRvbmEubW9vcm
VAZXhhbXBsZS5jb20iLCJpc3MiOiJodHRwczovL215LXRlbmFudC5hY2NvdW50cy5vbmRlbW
FuZC5jb20iLCJsYXN0X25hbWUiOiJNb29yZSIsInNhcF91aWQiOiIxMjM0NTZhYmM3ZGU4LW
ZnaGktOTEyMy1qNDU2LTc4OTEya2wzNG01NiIsImV4cCI6MTU4ODAxOTc4NywiaWF0IjoxNT
M5MDUyMDA2LCJmaXJzdF9uYW1lIjoiRG9uYSIsImp0aSI6IjI1MmViZjQ1LTEwYTgtNGU5My
04ZTZhLTBmZGE2YTNlNzFlYyJ9.D--uBbATOVX259bIJU6TgRTP26fD-jy-plwWzns5lyI",
 "token_type": "Bearer",
 "expires_in": 3600
}

or 

{
 "access_token": 
"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxMmEzNGI1Yy02ZDc4LTl
lMWYtZzM0NS02N2g4OWlqa2wxMjMiLCJzdWIiOiJQMTIzNDU2IiwibWFpbCI6ImRvbmEu
bW9vcmVAZXhhbXBsZS5jb20iLCJpc3MiOiJodHRwczovL215LXRlbmFudC5hY2NvdW50c
y5vbmRlbWFuZC5jb20iLCJsYXN0X25hbWUiOiJNb29yZSIsInNhcF91aWQiOiIxMjM0NT
ZhYmM3ZGU4LWZnaGktOTEyMy1qNDU2LTc4OTEya2wzNG01NiIsImV4cCI6MTU4ODAxOTA
0NCwiaWF0IjoxNTg4MDEzNzYwLCJub25jZSI6Im0tMEc2X0ZhUzNLZyIsImZpcnN0X25h
bWUiOiJEb25hIiwianRpIjoiMzhlNDIzMzAtZGU3YS00MTMwLWEzYTEtYjU4MmI1MjhkY
Tk4In0.J-aygbQ8IQlw4KD2t1hTPB2gyu3NdTbINDJ9eRs997g",
 "refresh_token": "d12a12abcd198765dd54r456e98321",
 "id_token": 
"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxMmEzNGI1Yy02ZDc4LTl
lMWYtZzM0NS02N2g4OWlqa2wxMjMiLCJzdWIiOiJQMTIzNDU2IiwibWFpbCI6ImRvbmEu
bW9vcmVAZXhhbXBsZS5jb20iLCJpc3MiOiJodHRwczovL215LXRlbmFudC5hY2NvdW50c
y5vbmRlbWFuZC5jb20iLCJsYXN0X25hbWUiOiJNb29yZSIsInNhcF91aWQiOiIxMjM0NT
ZhYmM3ZGU4LWZnaGktOTEyMy1qNDU2LTc4OTEya2wzNG01NiIsImV4cCI6MTU4ODAxOTA
0NCwiaWF0IjoxNTg4MDEzNzYwLCJub25jZSI6Im0tMEc2X0ZhUzNLZyIsImZpcnN0X25h
bWUiOiJEb25hIiwianRpIjoiMzhlNDIzMzAtZGU3YS00MTMwLWEzYTEtYjU4MmI1MjhkY
Tk4In0.J-aygbQ8IQlw4KD2t1hTPB2gyu3NdTbINDJ9eRs997g",
 "token_type": "Bearer",
 "expires_in": 3600
}

```

> ### Note:  
> The format of the `issuer` depends on the configuration in the administration console for SAP Cloud Identity Services. For more information, see [Tenant OpenID Connect Configurations](tenant-openid-connect-configurations-3d6abcc.md).



**Related Information**  


[Call Identity Authentication Refresh Token](call-identity-authentication-refresh-token-c62c09e.md "The refresh token is used to receive a new id token and access token, to be used when the old token is not valid or expires.")

