<!-- loio3a74ef862743445fb5d37f1afe1fe0a0 -->

# Configure the Client to Call Identity Authentication Token Endpoint for Authorization Code Flow

The token endpoint is used to get the user's access token, id token and refresh token.



This document explains how to call the token endpoint and what are the parameters supported by Identity Authentication.



## **Request**

**URI:**<code>https://<i class="varname">&lt;tenant ID&gt;</i>.accounts.ondemand.com/oauth2/token</code>

**HTTP Method:***POST*



### Request Headers


<table>
<tr>
<th valign="top">

Header



</th>
<th valign="top">

Required



</th>
<th valign="top">

Values



</th>
</tr>
<tr>
<td valign="top">

`Content-Type`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

application/x-www-form-urlencoded



</td>
</tr>
<tr>
<td valign="top">

`Authentication`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

-   Basic Authentication -

    Client ID and a Secret to authenticate the client \(relying party\). For more information, see [Configure Secrets for API Authentication](configure-secrets-for-api-authentication-5c3c35e.md).

    > ### Note:  
    > The client ID and secret must be encoded using the "application/x-www-form-urlencoded" encoding algorithm.

-   X.509 Certificate
-   JWT \(client\_assertion\)



</td>
</tr>
</table>



### Request Parameters


<table>
<tr>
<th valign="top">

Parameter



</th>
<th valign="top">

Required



</th>
<th valign="top">

Data Type



</th>
<th valign="top">

Description



</th>
<th valign="top">

Parameter Type



</th>
</tr>
<tr>
<td valign="top">

`grant_type`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

string



</td>
<td valign="top">

authorization\_code



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`code`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

string



</td>
<td valign="top">

The `code` generated by Identity Authentication in the authorize endpoint. It's returned wit'sh the request to the authorize endpoint.

> ### Note:  
> The `code` parameter can be used within 2 minutes after it generated and returned in the URL. It can be used only once.



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`redirect_uri`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

string



</td>
<td valign="top">

The same URL that has been sent with the authorization request. For more information, see [Configure OpenID Connect Application](configure-openid-connect-application-8a0aa2e.md).



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`client_id`



</td>
<td valign="top">

Yes



</td>
<td valign="top">

string



</td>
<td valign="top">

The user ID configured for basic authentication for the application. For more information, see [Configure Secrets for API Authentication](configure-secrets-for-api-authentication-5c3c35e.md).



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`code_verifier`



</td>
<td valign="top">

No



</td>
<td valign="top">

string



</td>
<td valign="top">

Validation value for the `code_challenge`. Required for PKCE.



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`refresh_expiry`



</td>
<td valign="top">

No



</td>
<td valign="top">

string



</td>
<td valign="top">

Reduces the expiry of a refresh token. It is useful if your application is called from mobile and web applications, and both have different session requirements. If you set the token lifetime to 0 or less, you won't receive a `refresh_token` in response.



</td>
<td valign="top">

Request body



</td>
</tr>
<tr>
<td valign="top">

`token_format`



</td>
<td valign="top">

No



</td>
<td valign="top">

String



</td>
<td valign="top">

The `token_format` can be set to `opaque` to retrieve an opaque access token or to `jwt` to retrieve a JWT based access token. If not set, the current defaults per grant type are used.



</td>
<td valign="top">

Request body



</td>
</tr>
</table>



### Request Example

```
grant_type=authorization_code&client_id=12b52d2c-1q34-5r5t-a576-75e85asdf523&code=768fsd1206we951236729134fa4a247ee&redirect_uri=https://www.example.com
```





### Request Example with PKCE

```
grant_type=authorization_code&client_id=23q45d2c-1e98-4c7f-a576-69e85dddb456&code=b1d87f103c9f4c8a936a2f164c8728a0&redirect_uri=https://www.example.com&code_verifier=e4yAeaa_OLJ-8ZC1sj6JWFqgRK8QR-egfqG4lQlsy0~NOrjOcVdIpPxPvUEsG1Il1LP76F0MGr4a0miVD2Z84Gn_Lw67BhZ9GQDTF6wN_fUwQtJJeN3bnvk7J.Ty6jDi
```



## **Response**



### Response Status and Error Codes


<table>
<tr>
<th valign="top">

Code



</th>
<th valign="top">

Reason



</th>
<th valign="top">

Description



</th>
</tr>
<tr>
<td valign="top">

200 OK



</td>
<td valign="top">

Successful operation.



</td>
<td valign="top">

Returns `access_token`, `refresh_token`, and `id_token`.

> ### Note:  
> The `refresh_token` is used to obtain a new `id_token` and `access_token` when the current token becomes invalid or expires. For more information, see [Call Identity Authentication Refresh Token](call-identity-authentication-refresh-token-c62c09e.md).
> 
> The `id_token` is in the form of a JWT \(JSON Web Token\) and contains information about the user. The `id_token` is valid for 60 minutes.



</td>
</tr>
<tr>
<td valign="top">

400 Bad Request



</td>
<td valign="top">

Missing or wrong parameter.



</td>
<td valign="top">

Returns information about the error.



</td>
</tr>
</table>



### Response Payload Example

```

{
 "access_token": 
"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxMmEzNGI1Yy02ZDc4LTl
lMWYtZzM0NS02N2g4OWlqa2wxMjMiLCJzdWIiOiJQMTIzNDU2IiwibWFpbCI6ImRvbmEu
bW9vcmVAZXhhbXBsZS5jb20iLCJpc3MiOiJodHRwczovL215LXRlbmFudC5hY2NvdW50c
y5vbmRlbWFuZC5jb20iLCJsYXN0X25hbWUiOiJNb29yZSIsInNhcF91aWQiOiIxMjM0NT
ZhYmM3ZGU4LWZnaGktOTEyMy1qNDU2LTc4OTEya2wzNG01NiIsImV4cCI6MTU4ODAxOTA
0NCwiaWF0IjoxNTg4MDEzNzYwLCJub25jZSI6Im0tMEc2X0ZhUzNLZyIsImZpcnN0X25h
bWUiOiJEb25hIiwianRpIjoiMzhlNDIzMzAtZGU3YS00MTMwLWEzYTEtYjU4MmI1MjhkY
Tk4In0.J-aygbQ8IQlw4KD2t1hTPB2gyu3NdTbINDJ9eRs997g",
 "refresh_token": "d12a12abcd198765dd54r456e98321",
 "id_token": 
"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxMmEzNGI1Yy02ZDc4LTl
lMWYtZzM0NS02N2g4OWlqa2wxMjMiLCJzdWIiOiJQMTIzNDU2IiwibWFpbCI6ImRvbmEu
bW9vcmVAZXhhbXBsZS5jb20iLCJpc3MiOiJodHRwczovL215LXRlbmFudC5hY2NvdW50c
y5vbmRlbWFuZC5jb20iLCJsYXN0X25hbWUiOiJNb29yZSIsInNhcF91aWQiOiIxMjM0NT
ZhYmM3ZGU4LWZnaGktOTEyMy1qNDU2LTc4OTEya2wzNG01NiIsImV4cCI6MTU4ODAxOTA
0NCwiaWF0IjoxNTg4MDEzNzYwLCJub25jZSI6Im0tMEc2X0ZhUzNLZyIsImZpcnN0X25h
bWUiOiJEb25hIiwianRpIjoiMzhlNDIzMzAtZGU3YS00MTMwLWEzYTEtYjU4MmI1MjhkY
Tk4In0.J-aygbQ8IQlw4KD2t1hTPB2gyu3NdTbINDJ9eRs997g",
 "token_type": "Bearer",
 "expires_in": 3600
}
```

> ### Note:  
> The format of the `issuer` depends on the configuration in the administration console for SAP Cloud Identity Services. For more information, see [Tenant OpenID Connect Configurations](tenant-openid-connect-configurations-3d6abcc.md).



**Related Information**  


[OpenID Connect](openid-connect-a789c9c.md "You can use Identity Authentication for authentication in OpenID Connect protected applications.")

[Configure the Client to Call Identity Authentication Authorize Endpoint for Authorization Code Flow with PKCE](configure-the-client-to-call-identity-authentication-authorize-endpoint-for-authorization-a721157.md "The authorization code flow with PKCE is recommended for public clients that arenâ€™t capable of keeping the client secrets.")

