<!-- loio9379444abf3f4e2cbaade7c4001df381 -->

# Reference Information for the Identity Service of SAP BTP

Properties enable you to customize the configuration of the Identity service.



<a name="loio9379444abf3f4e2cbaade7c4001df381__section_sy4_ffh_wnb"/>

## Service Properties

> ### Tip:  
> If you are creating a new tenant via subscription, `Cloud Identity Services` support only the `cloud_service` configuration parameter for the subscription creation. The supported values are: `PRODUCTIVE` and `TEST`. If you provide different parameter or values the tenant won't be created. For more information about the tenant creation, see [Get Your Tenant](../get-your-tenant-460766b.md).
> 
> If you want to customize the configuration of the Identity service, follow the rest of the information in this document.

Provide properties in JSON format.

The syntax of the properties is as follows:

```

        {
	"name": "opportunity-management",
	"authorization": {
		"enabled": true,
		"value_help_url": "https://myapp_namespace.cert.cfapps.eu10.hana.ondemand.com/odata/v4/ValueHelpService/"
	},
   "oauth2-configuration": {
                "redirect-uris": ["https://*.myapp_namespace.cfapps.eu10.hana.ondemand.com/**"],
	        "post-logout-redirect-uris": ["https://*.myapp_namespace.cfapps.eu10.hana.ondemand.com/logout/**"],
	        "front-channel-logout-uris": ["https://myapp.mydomain.com/fc-logout"],
	        "public-client": false,
	        "grant-types": ["client_credentials", "authorization_code"],
	        "token-policy": {
		      "token-validity": 1800,
		      "refresh-validity": 7776000,
		      "refresh-parallel" : 3,
		      "refresh-usage-after-renewal" : "off"
		}
	},
	"consumed-services": [{
		"service-instance-name": "app_log"
	}],
	"display-name": "Opportunity Management",
	"subject-name-identifier": {
		"attribute": "userUuid",
		"fallback-attribute": "uid"
                }
	},
	"provided-apis": [{
		"name": "write-access",
		"description": "grants access to write APIs"
	        }]
        }

```

**Properties for the Creation of an Instance of the Identity Service**


<table>
<tr>
<th valign="top">

Property

</th>
<th valign="top">

Description

</th>
</tr>
<tr>
<td valign="top">

`name`

</td>
<td valign="top">

Sets the technical name of the application. The admin console shows this name below the display name in the list of applications and as the name of the *OpenID Connect Configuration*.

> ### Restriction:  
> The name must be unique in your tenant.

By default, the Cloud Identity Services service uses the instance ID generated by the `create-instance` command.

</td>
</tr>
<tr>
<td valign="top">

`authorization`

</td>
<td valign="top">

Integrates the SAP Cloud Identity Services - Authorization Management service, enabling instance-based authorizations for your application.

For more information about developing applications with Authorization Management, see [Developing Authorizations](../Development/developing-authorizations-22928a2.md).

The `enabled` property is false by default. Set this value to true to create an instance of the service for your SAP Cloud Identity Services tenant.

The `value_help_url` property is an absolute URL that points to an OData service of your application. The OData service serves values for attributes defined in the DCL schema of your application.

Limits:

-   The format must be `https://host/path`

    No fragments \(`#`\) allowed

    HTTPS only




</td>
</tr>
<tr>
<td valign="top">

`redirect-uris`

</td>
<td valign="top">

An array of redirect URIs that are explicitly allowed for the authorization code flow.

> ### Restriction:  
> Redirect URIs are required for the authorization code flow to redirect back to your application.

This property is empty by default.

For more information, see [OpenID Connect Application Configurations](../Operation-Guide/openid-connect-application-configurations-1ae324e.md).

</td>
</tr>
<tr>
<td valign="top">

`post-logout-redirect-uris`

</td>
<td valign="top">

An array of redirect URIs, where users can be forwarded after logout.

This property is empty by default.

For more information, see [Call Identity Authentication End Session Endpoint](../Operation-Guide/call-identity-authentication-end-session-endpoint-ec674f4.md) and [OpenID Connect Application Configurations](../Operation-Guide/openid-connect-application-configurations-1ae324e.md).

</td>
</tr>
<tr>
<td valign="top">

`front-channel-logout-uris`

</td>
<td valign="top">

An array of logout URIs, which are called in a logout flow.

This property is empty by default.

For more information, see [OpenID Connect Application Configurations](../Operation-Guide/openid-connect-application-configurations-1ae324e.md).

</td>
</tr>
<tr>
<td valign="top">

`public-client`

</td>
<td valign="top">

Set to `true` to enable OAuth flows with public clients. Use public clients in environments where it’s difficult to protect client credentials, such as mobile and desktop applications or client-side parts of web applications.

This property is `false` by default.

For more information, see:

-   [Configure OpenID Connect Application for Authorization Code Flow](../Operation-Guide/configure-openid-connect-application-for-authorization-code-flow-4a94254.md)

-   [Configure the Client to Call Identity Authentication Authorize Endpoint for Authorization Code Flow with PKCE](../Operation-Guide/configure-the-client-to-call-identity-authentication-authorize-endpoint-for-authorization-a721157.md)




</td>
</tr>
<tr>
<td valign="top">

`grant-types`

</td>
<td valign="top">

An array of allowed grant types. By default, the following grant types are allowed: `client_credentials`, `password`, `authorization_code`, `refresh_token`, and `urn:ietf:params:oauth:grant-type:token-exchange`.

The following grant types can be added: `implicit`, `urn:ietf:params:oauth:grant-type:jwt-bearer` and `authorization_code_pkce_s256`.

</td>
</tr>
<tr>
<td valign="top">

`token-policy`

</td>
<td valign="top">

Defines the token policy for the application as determined by the optional properties `token-validity`, `refresh-validity`, and `refresh-parallel`.

The admin console also supports the configuration of token policies.

For more information, see [Token Policy Configuration for Applications](../Operation-Guide/token-policy-configuration-for-applications-c4ba52e.md).

</td>
</tr>
<tr>
<td valign="top">

`token-validity`

</td>
<td valign="top">

Sets the lifetime in seconds of tokens issued by the service. The value can range from 60 to 43,200, in other words, from 1 minute to 12 hours.

The default value is 3600 seconds, which translates to 1 hour.

</td>
</tr>
<tr>
<td valign="top">

`refresh-validity`

</td>
<td valign="top">

Sets the refresh lifetime of tokens issued by the service. During the refresh lifetime of a token, the service can reissue the token for a user. The value can range from 3600 to 15552000, in other words, from 1 hour to 180 days. Setting the value to 0 disables the refreshing of tokens.

The default value is 43200 seconds, which translates to 12 hours.

</td>
</tr>
<tr>
<td valign="top">

`refresh-parallel`

</td>
<td valign="top">

Determines the number of tokens that can be issued for the same session in parallel. Imagine you're logged on to the application through a web interface and a command-line interface in parallel. Then you would want this property to be set to 2. The value can range from 1 to 10.

The default value is 1.

</td>
</tr>
<tr>
<td valign="top">

`refresh-usage-after-renewal`

</td>
<td valign="top">

Defines the validity of the old refresh token after requesting a new one through the refresh token grant type. The attribute supports the following values:

-   `off` - The new refresh token immediately invalidates the old one.

-   `online` - The new refresh token is created and the old one is still active for 5 minutes.

-   `mobile` - The new and old refresh tokens are valid during the configured refresh token life time.



</td>
</tr>
<tr>
<td valign="top">

`access-token-format`

</td>
<td valign="top">

Defines the format of access tokens.

-   `default` - The access token format is dependent on the grant type.

    For more information, see [Token Policy Configuration for Applications](../Operation-Guide/token-policy-configuration-for-applications-c4ba52e.md).

-   `jwt` - The access token format is JWT.

-   `opaque` - The access token format is opaque.




</td>
</tr>
<tr>
<td valign="top">

`consumed-services`

</td>
<td valign="top">

Use this array to enable the application to consume the APIs of reuse services. Name the reuse services consumed by the application you’re protecting. The system adds the client IDs of the reuse services to the audience claim of the identity token.

> ### Note:  
> If the token is retrieved based on a public flow \(`public-client` is true\) without client authentication, Cloud Identity Services doesn't add the client IDs of the dependent services to the audience claim.

This property is empty by default.

</td>
</tr>
<tr>
<td valign="top">

`xsuaa-cross-consumption`

</td>
<td valign="top">

Set to `true` to add the client ID of the Cloud Identity Services application created by the SAP Authorization and Trust Management service \(XSUAA\) to the audience claim. Setting `xsuaa-cross-consumption` enables cross-consumption of SAP Authorization and Trust Management service.

> ### Note:  
> If the token is retrieved based on a public flow \(`public-client` is true\) without client authentication, Cloud Identity Services doesn't add the client IDs of the dependent services to the audience claim.

The default value is `false`.

</td>
</tr>
<tr>
<td valign="top">

`display-name`

</td>
<td valign="top">

Sets the name of the application that you create with the Cloud Identity Services service. Enter a maximum of 99 characters.

> ### Recommendation:  
> Provide a display name, which helps the person who administrates the Cloud Identity Services service to understand the purpose of the application.

By default, the Cloud Identity Services service uses the name of the instance you provide in the `create-instance` command.

</td>
</tr>
<tr>
<td valign="top">

`subject-name-identifier`

</td>
<td valign="top">

Sets the value to use to fill the subject claim in tokens issued by the service.

The `attribute` attribute identifies the user attribute used to fill the subject claim. The attribute supports the following values:

-   `userUuid`

-   `uid`

-   `mail`

-   `displayName`

-   `loginName`

-   `personnelNumber`


For more information about attributes for the subject name identifier, see [Configure the Subject Name Identifier Sent to the Application](../Operation-Guide/configure-the-subject-name-identifier-sent-to-the-application-1d020e3.md).

</td>
</tr>
<tr>
<td valign="top">

`provided-apis`

</td>
<td valign="top">

An array of API names \(`name`\) and descriptions \(`description`\) which this application makes available for other applications to consume.

> ### Caution:  
> The API name must match exactly what is expected by consumer applications. The name must be unique within all APIs provided by the same provider application. Consumer applications use this name to determine if their application has the rights to access the provider application.
> 
> The name can be any URN-compliant string of up to 32 characters. You can define a maximum of 50 APIs.
> 
> For more information about URNs, see [RFC 8141](https://datatracker.ietf.org/doc/rfc8141/).

For more information, see [Consuming APIs from Other Applications](../Development/consuming-apis-from-other-applications-29e204d.md).

</td>
</tr>
</table>



<a name="loio9379444abf3f4e2cbaade7c4001df381__section_sv2_4d2_ynb"/>

## Binding Properties

Provide binding properties in JSON format. If you provide no properties, the binding uses the `SECRET` credential type. The syntax of the properties is as follows:

```
{"credential-type": "SECRET"}
```

Or:

```
{
    "credential-type": "X509_GENERATED", 
    "key-length": 2048, 
    "validity": 30, 
    "validity-type": "DAYS",
    "app-identifier":"myApplication"
}
```

Or:

```
{
    "credential-type": "X509_PROVIDED", 
    "certificate": "-----BEGIN CERTIFICATE-----\nMIID6zC…\n-----END CERTIFICATE-----"
}
```

Or:

```
{"credential-type": "NONE"}
```

> ### Restriction:  
> You can bind a maximum of 100 applications to a single service instance.
> 
> You can have a maximum of 20 different certificate subject DNs.

**Credential Types for the Binding of an Instance of the Identity Service**


<table>
<tr>
<th valign="top">

Credential Type

</th>
<th valign="top">

Credential Properties

</th>
<th valign="top">

Description

</th>
</tr>
<tr>
<td valign="top" colspan="2">

`SECRET`

</td>
<td valign="top">

Generates a client secret. If no properties are provided, `SECRET` is the default type.

</td>
</tr>
<tr>
<td valign="top" rowspan="5">

`X509_GENERATED`

</td>
<td valign="top">

 

</td>
<td valign="top">

Generates an X.509 certificate and private key.

</td>
</tr>
<tr>
<td valign="top">

`key-length`

</td>
<td valign="top">

Specifies the byte length of the generated private key. The default length is `2048` bytes. You can also choose `4096` bytes.

</td>
</tr>
<tr>
<td valign="top">

`validity`

</td>
<td valign="top">

Specifies the number of time units for `validity-type`. The default value is `30`.

Together with the `validity-type` the range of validity runs from 1 day to 1 year.

</td>
</tr>
<tr>
<td valign="top">

`validity-type`

</td>
<td valign="top">

Specifies the time unit for `validity`. Supported values are `DAYS`, `MONTHS`, and `YEARS`. The default value is `DAYS`.

</td>
</tr>
<tr>
<td valign="top">

`app-identifier`

</td>
<td valign="top">

Enables you to generate a certificate with stable subject. The identifier eases the rotation of the certificates for your microservice while keeping the subject stable. The maximum length is 20 characters.

</td>
</tr>
<tr>
<td valign="top" colspan="2">

`X509_PROVIDED`

</td>
<td valign="top">

Creates a binding using a certificate that you provide from a trusted certificate authority \(Certification Authority\). This certificate can be used to request tokens.

> ### Restriction:  
> Don't forget the new lines \(`\n`\) after `-----BEGIN CERTIFICATE-----` and before `-----END CERTIFICATE-----`. See the previous example.
> 
> The certificate you provide must be unique in the Cloud Identity Services tenant.



</td>
</tr>
<tr>
<td valign="top" colspan="2">

`NONE`

</td>
<td valign="top">

No credentials are added to the binding. Used for public clients.

For more information, see [Configure the Client to Call Identity Authentication Authorize Endpoint for Authorization Code Flow with PKCE](../Operation-Guide/configure-the-client-to-call-identity-authentication-authorize-endpoint-for-authorization-a721157.md).

</td>
</tr>
</table>



<a name="loio9379444abf3f4e2cbaade7c4001df381__section_ss1_htq_xnb"/>

## Binding Information

The service key or binding provides the following information.

-   Client ID

-   Secrets

    Secrets provided depend on how the service was configured.

    -   By default the service generates a client secret.

    -   If you had the service generate an X.509 certificate, the binding includes the key and the certificate.

        If you provided the service with your own X.509 certificate, the binding includes the certificate.

    -   For public clients, you can suppress the creation of a secret.


-   Cloud Identity Services domains

-   Cloud Identity Services URL


The following examples show the information stored in the binding:

Binding with client ID and client secret:

```
{
  "clientid": "1aa234ca-faed-4fb2-966e-7c86262ba93c",
  "clientsecret": "<secret>",
  …
  "domains": ["accounts.ondemand.com", "accounts.cloud.sap"],
  "url": "https://caev6ngwk.accounts.ondemand.com"
}
```

Binding with generated X.509 certificate:

```
{
  "clientid": "1aa234ca-faed-4fb2-966e-7c86262ba93c",
  "key": "<content>",
  "certificate": "<content>",
  …
  "domains": ["accounts.ondemand.com", "accounts.cloud.sap"],
  "url": "https://caev6ngwk.accounts.ondemand.com"
}
```

Binding with provided X.509 certificate:

```
{
  "clientid": "1aa234ca-faed-4fb2-966e-7c86262ba93c",
  "certificate": "<content>",
  …
  "domains": ["accounts.ondemand.com", "accounts.cloud.sap"],
  "url": "https://caev6ngwk.accounts.ondemand.com"
}
```

Binding with no credentials:

```
{
  "clientid": "1aa234ca-faed-4fb2-966e-7c86262ba93c",
  "credential-type": "NONE",
  …
  "domains": ["accounts.ondemand.com", "accounts.cloud.sap"],
  "url": "https://caev6ngwk.accounts.ondemand.com"
}
```



<a name="loio9379444abf3f4e2cbaade7c4001df381__section_lc5_qh4_znb"/>

## Code Flows

For information about how the Cloud Identity Services service supports code flows, see [Configuring OpenID Connect](../Operation-Guide/configuring-openid-connect-a789c9c.md).



<a name="loio9379444abf3f4e2cbaade7c4001df381__section_tc5_qh4_znb"/>

## Token Validation

To validate tokens, we provide client libraries to support the authentication of tokens.

-   For Java, see [SAP BTP Java Security Client Library](https://github.com/SAP/cloud-security-xsuaa-integration/tree/master/java-security) on *GitHub*. The Java library supports authentication of tokens from version 2.8.0.

-   For node.js, see [@sap/xssec: XS Advanced Container Security API for node.js](https://www.npmjs.com/package/@sap/xssec) on *npm*.




<a name="loio9379444abf3f4e2cbaade7c4001df381__section_dqz_qh4_znb"/>

## Token Attributes

The administrator of the Cloud Identity Services service determines what attributes are available in tokens. For more information, see [Configuring User Attributes from the Identity Directory](../Operation-Guide/configuring-user-attributes-from-the-identity-directory-d361407.md).

